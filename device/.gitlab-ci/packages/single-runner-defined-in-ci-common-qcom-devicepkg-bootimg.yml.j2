# Use this gitlab-ci snippet if your package:
#
# * is a Qualcomm device
# * has its runner tags definition found in ci-common's ci-tron/common.yml
# * uses U-boot as bootloader
# * The devicepackage does not support U-boot and UEFI, but still uses the stock
#   bootloader
test-{{ device.name }}:
  extends:
    # Extended from jobs defined in ci-common/ci-tron/common.yml
    - .pmos-ci-tron-runner-{{ device.name }}

    # Extended from build-jobs.yaml.j2
    - .device-boot-flow-separate-artifacts
    - .test-{{ device.name }}

  variables:
    # Let CI-tron construct the bootimg accepted by U-boot in a standard
    # Qualcomm way
    CI_TRON_FASTBOOT__HEADER_VERSION: 2
    CI_TRON_FASTBOOT__BASE: 0x00000000
    CI_TRON_FASTBOOT__KERNEL_OFFSET: 0x00008000
    CI_TRON_FASTBOOT__RAMDISK_OFFSET: 0x01000000
    CI_TRON_FASTBOOT__TAGS_OFFSET: 0x00000100
    CI_TRON_FASTBOOT__PAGESIZE: 4096
    CI_TRON_KERNEL_CMDLINE__CONSOLE: "console=ttyMSM0,115200"
    KERNEL_NAME: "vmlinuz"
