# Reference: <https://postmarketos.org/devicepkg>
maintainer="Luca Weiss <luca@lucaweiss.eu>"
pkgname=device-fairphone-fp3
pkgdesc="Fairphone 3"
pkgver=6
pkgrel=1
url="https://postmarketos.org"
license="MIT"
arch="aarch64"
options="!check !archcheck"
depends="
	firmware-fairphone-fp3-adreno
	firmware-fairphone-fp3-adsp
	firmware-fairphone-fp3-audio
	firmware-fairphone-fp3-modem
	firmware-fairphone-fp3-venus
	firmware-fairphone-fp3-wcnss
	firmware-qcom-adreno-a530
	linux-postmarketos-qcom-msm8953
	lk2nd-msm8953
	mkbootimg
	msm-modem-uim-selection
	postmarketos-base
	qbootctl
	rmtfs
	soc-qcom-msm8953
	unl0kr-fbforcerefresh
"
makedepends="devicepkg-dev"
subpackages="$pkgname-openrc"
source="deviceinfo modules-initfs"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	devicepkg_package $startdir $pkgname
}

openrc() {
	install_if="$pkgname=$pkgver-r$pkgrel openrc"
	install="$subpkgname.post-install $subpkgname.post-upgrade"
	depends="
		openrc
		qbootctl-openrc
	"

	mkdir -p "$subpkgdir"
}

sha512sums="
b6b778f091fefc75928eb2ba350c04e176a9465a06603a3a939a9a48efadb66977662fbdd41b8714c13c8b6e1347ba86c927d094563c302c38baf81216d9088a  deviceinfo
c56e5b11dc5ecaba8bb5ff0e06a1f2746942eebb0336257e44e673e849f440a6800e5b30e297e5827fb540778e4400daa31b76f521b3e804279c0c2b3329267f  modules-initfs
"
