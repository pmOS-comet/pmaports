# Maintainer: Stefan Hansson <newbyte@postmarketos.org>
pkgname=dint
pkgver=0.0.3
pkgrel=0
pkgdesc="postmarketOS deviceinfo validator, linter, and documentation generator"
url="https://gitlab.postmarketos.org/postmarketOS/dint"
arch="all"
license="EUPL-1.2"
makedepends="cargo cargo-auditable"
source="https://gitlab.postmarketos.org/postmarketOS/dint/-/archive/$pkgver/dint-$pkgver.tar.bz2"
options="!pmb:crossdirect"

prepare() {
	default_prepare

	cargo fetch --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/dint \
		-t "$pkgdir"/usr/bin
	install -Dm644 deviceinfo_schema.toml \
		-t "$pkgdir"/usr/share/dint
}

sha512sums="
30b9152b4c6c5a8b13be1ff5569ed40e906079b7b15324dd08950996811e60ffa8c51619e4d1b7ed787556a1a391c7e99ceb59c95191f793fb4bf6face469be3  dint-0.0.3.tar.bz2
"
